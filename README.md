# what_seoul


><center style="font-style: italic">서울 어딘가로 떠나고 싶은 오늘,<br>서울시 실시간 <strong style="font-style: normal">날씨</strong>, <strong style="font-style: normal">혼잡도</strong>와 <strong style="font-style: normal">문화행사</strong>를 장소별로 확인하세요!</center> 

[서울시 공공데이터](https://data.seoul.go.kr/dataList/OA-21285/F/1/datasetView.do)를 활용하여, 서울시 주요 120개 장소의 날씨, 인구, 문화행사 정보를 제공합니다. <br>
서울 실시간 도시데이터 조회 서비스 [왓서울(WhatSeoul)](https://github.com/WhatSEOUL/WhatSeoul) 를 일부 개선하여 새롭게 개발된 웹 서비스입니다.
<br><br>

## 🔆 개요
- 개발 기간: 2025.03.03~ (진행중)
- 개발 인원: 1인
  <br><br>

## ☕ 기술 Stack
- 주 언어 : Java 17
- 프레임워크 : Spring Boot 3.4.3
- DB : MySQL, Spring Data JPA, Querydsl
- 빌드 및 테스트 : Gradle, JUnit
- 템플릿 엔진 : Thymeleaf (+ HTML/CSS, Javascript)
- Cloud & CI/CD: AWS RDS/EC2/CodeDeploy, Github Actions, Nginx
- 인증·인가: Spring Security, JWT, Redis
  <br><br>

## 🫚 브랜치 전략
- main : 실제 서비스 운영 환경에 사용하기 위한 브랜치
- dev : 로컬 개발 환경에서 사용하기 위한 브랜치
    - 하위에 feat/#N과 같이 이슈 번호를 바탕으로 하위 브랜치를 생성하여 작업합니다.
- 하위 브랜치 종류
    - feat : 신규 피쳐 도입
    - fix : 오류 수정 및 개선
    - docs : 문서화 반영
    - test : 테스트 작성
      <br><br>

## ⚙️ 시스템 설계도
<img alt="시스템 설계도" src="https://github.com/user-attachments/assets/43880698-77bb-426d-968b-5c975198bbc4" />
<br><br>

## 🚀 CI/CD 모식도
<img alt="CICD 모식도" src="https://github.com/user-attachments/assets/264cf12a-4053-461b-b7d8-c46e2b24cb50" />
<br><br>

## 💾 ERD
<img alt="what_seoul_database_deploy" src="https://github.com/user-attachments/assets/7909ece6-aec4-46f7-980a-64c96a2f0120" />
<br><br>

## 📃 API 명세서
[명세서 링크](https://biiit4894.github.io/whatseoul-swagger/)<br>
(링크 마우스 우클릭 후 '새 탭에서 링크 열기'를 추천합니다.)

<br><br>

## 주요 개선점
1. 장소별 도시데이터 조회 UI 가시성 개선
  - 기존 UI
    - 장소별 버튼을 클릭하는 방식으로 서울시 내 주요 장소를 사전에 직접 선택한 이후, 별도의 페이지에서 장소별 도시데이터를 조회 
  - 개선 UI
    - 서울시 주요 장소 116곳을 모두 폴리곤 형태로 지도에 표기한 후, 그 위에 유형별 도시데이터 (인구/날씨/문화행사)를 나타내어 주요 장소의 지리적 위치와 데이터 지표를 함께 조회할 수 있도록 개선
    - 폴리곤을 클릭한 후, 인구/날씨/문화행사로 구분되는 버튼을 클릭하여 지도 위 모달창에 유형별 도시데이터를 조회하도록 분리
   
2. 장소별 도시데이터 조회 방식 다변화
  - 기존 조회 방식
    - 장소 한 곳을 선택하여, 해당 장소의 인구/날씨/문화행사 데이터를 한 번에 모두 조회
  - 변경된 방식
    1. 장소 한 곳을 선택한 후, 인구/날씨/문화행사 데이터 중 한 유형의 데이터를 선택해 조회
    2. 전체 장소에 대한 인구 혼잡도를 지도상에서 조회 (장소별 폴리곤의 색상을 통해 혼잡도 표현)
    3. 전체 장소에 대한 날씨 현황을 지도상에서 조회 (장소별 폴리곤에 기온 표기)
    4. 전체 장소에 대한 도로명주소별 문화행사 정보를 지도상에서 조회 (장소별 폴리곤에 문화행사 주소마다의 마커 표기)
<br><br>

## 주요 기능

서울시 주요 장소 116곳에 대한 실시간 도시데이터 조회
- 장소별 인구 현황 조회
- 장소별 날씨 현황 조회
- 장소별 문화행사 정보 조회 
- 장소 전체 인구 혼잡도 조회
- 장소 전체 기온 조회
- 장소 전체 도로명주소별 문화행사 조회

장소 검색 및 조회 기능
- 현위치 인근 주요 장소 조회
- 장소 검색

문화행사 후기 작성 기능
- 문화행사 후기 작성/조회/수정/삭제 기능


## 📊 도시데이터 저장 스케줄러
> '왓서울'은 1) 서울시 공공데이터 API가 제공하는 데이터의 최단 갱신 주기에 맞추어, 2) 유형별 도시데이터의 특성을 고려하여 도시 데이터를 관리하고 있습니다.

<details>
    <summary>더 자세히 알아보기</summary><br>
'왓서울'은 스케줄러를 사용해 서울시 도시데이터 공공 API를 주기적으로 호출하고, 호출 결과 얻은 XML 데이터를 파싱하여 장소별 날씨, 인구, 문화행사 데이터를 저장하고 있습니다. 이 작업은 스케줄링을 통해 이루어지고 있는데, '왓서울'의 유저에게 가장 최신의 데이터를 정확히 전달하되, 주어진 DB 환경에 적합한 용량의 데이터를 저장하는 방식을 고민하고 있습니다. 이 과정에서, 현재는 각 유형별 데이터의 갱신 주기와 데이터 특성을 고려하기 위해 조금씩 다른 저장 방식을 채택하였습니다.

### 날씨 및 인구 데이터 저장 방식
서울시 도시데이터 공공 API가 제공하는 날씨 현황, 인구 현황, 예측 인구 현황 데이터는 가장 짧을 경우 5분의 간격으로 갱신됩니다. 따라서, '왓서울'은 5분 간격으로 공공 API를 호출하여 서울시 주요 장소 120곳에 대한 이 세 종류의 데이터를 저장합니다. 이는 5분 마다 1,680개의 행을 데이터베이스에 추가하게 되는데, 이 데이터들이 계속 저장된다면 수만 건의 데이터가 누적되는 부하가 일어날 수 있습니다. 따라서 날씨 현황, 인구 현황, 예측 인구 현황 데이터의 경우 적은 양의 최신 데이터만을 남기고 오래된 데이터를 제거하고 있습니다.<br><br>
물론, 향후 날씨 및 인구 정보와 관련하여 유저가 직접 어떠한 데이터를 추가할 수 있도록 서비스가 변화하거나, 날씨 및 인구 정보를 다건 누적하여 통계에 활용하게 된다면 이 방식에 변화가 필요할 것으로 예상합니다.

### 문화행사 데이터 저장 방식
서울시 공공데이터 API가 제공하는 문화행사 데이터의 경우, 날씨 및 인구 데이터와 달리 비교적 긴 주기인 1일을 기준으로 신규 데이터가 추가됩니다. 그러나 관찰 결과, 동일한 문화행사 정보가 미세하게 수정되는 경우가 있었습니다. 따라서, '왓서울'은 서울시 주요 장소 120곳의 문화행사 정보를 하루 간격이 아니라 일 4회 달라진 정보는 없는지, 완전히 새로운 정보는 없는지 확인하는 방식을 선택했습니다. 서울시 도시데이터 공공 API를 호출했을 때, DB에 있는 행사 정보와 동일한 행사 이름, 행사 장소를 가진 데이터가 조회된다면, 행사 기간, 행사 좌표, 썸네일 등 달라진 정보가 없는지 확인하여 갱신합니다. DB에 있는 행사 정보와 완전히 다르다면, 새로이 저장합니다.

### 종료된 문화행사 데이터 관리 방식
모든 문화행사에는 행사 기간이 존재하고, 이는 짧게는 하루에서 길게는 몇개월에 이릅니다. '왓서울'은 종료된 행사의 데이터를 바로 삭제하는 대신, 유보 기간을 두고 있습니다. 일정 시간마다, 종료된지 일정 기간이 경과하였고, 후기가 존재하지 않는 문화행사 정보라면 데이터베이스에서 완전히 제거합니다. 그러나 종료된지 일정 기간이 지나지 않았거나, 후기가 존재하는 경우라면 데이터베이스에서 제거하지 않습니다. 이는 첫째로는 종료된 문화행사 정보 또한 유저에게 필요한 정보일 수 있기 때문이며, 둘째로는 행사가 종료되기 전, 유저가 작성하였던 후기 데이터를 보호하기 위함입니다.

</details>


---
